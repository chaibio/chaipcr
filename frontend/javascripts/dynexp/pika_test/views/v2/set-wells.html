<div ng-controller="PikaSetWellsCtrl">
  <div class="pika-wrapper">
    <header-exp-status experiment-id="experiment.id">
      <div class="home-link CB1-M" ui-sref="home()">
        <img src='/images/dynexp/pika-test/menu-back-white-only.svg'/>
        Back to Home
      </div>
    </header-exp-status>
    <header class="exp-header">
      <span class="CB2-M sub-caption">Assign wells for experiment:</span>
      <inline-exp-name-editor></inline-exp-name-editor>
    </header>
    <div class="pika-content">
      <section class="well-container">
        <div class="well-panel">
          <div class="d-flex">
            <h1 class="CH1">{{ is_two_kit ? 'Test Kit1' : 'Test Kit'}}</h1>
            <h1 class="CH1" ng-if="is_two_kit">Test Kit2</h1>
          </div>
          <div class="d-flex mt-20">
            <div class="well-table">
              <div class="well-row d-flex align-items-center" ng-repeat="x in samples track by $index">
                <span class="CB2 number">A{{$index+1}}.</span>
                <input
                  type="text" 
                  class="CB1-M name" 
                  ng-model="x.name"                  
                  readonly
                  ng-if="isControlWell(x, $index, 'A')"
                  ng-focus="focusWell('A', $index, x.name)"
                  >
                <input
                  type="text" 
                  class="CB1-M name" 
                  ng-class="{'empty-input':!x.name}" 
                  ng-model="x.name"
                  ng-blur="updateWellA($index,x)"
                  ng-focus="focusWell('A', $index, x.name)"
                  ng-if="!isControlWell(x, $index, 'A')"
                  >
                <label class="CG1 type" ng-class="{'positive': x.name == 'Positive Control', 'negative': x.name == 'Negative Control', 'available': x.id}">
                  {{(x.name == 'Positive Control') ? '+' : ( (x.name == 'Negative Control') ? '-' : 'S' )}}
                </label>
                <img src="/images/dynexp/pika-test/note-disable.svg" class="note" ng-if="!x.id"/>
                <img src="/images/dynexp/pika-test/note-on.svg" class="note cursor-pointer note-{{'A'+$index}}" ng-if="x.id && x.notes" ng-click="openNotes($index, x, 'A')"/>
                <img src="/images/dynexp/pika-test/note-off.svg" class="note cursor-pointer note-{{'A'+$index}}" ng-if="x.id && !x.notes" ng-click="openNotes($index, x, 'A')"/>
              </div>
            </div>
            <div class="well-table">
              <div class="well-row d-flex align-items-center" ng-repeat="x in samples_B track by $index">
                <span class="CB2 number">B{{$index+1}}.</span>
                <input
                  type="text" 
                  class="CB1-M name" 
                  ng-model="x.name"
                  readonly
                  ng-if="isControlWell(x, $index, 'B')"
                  ng-focus="focusWell('B', $index, x.name)"
                  >
                <input
                  type="text" 
                  class="CB1-M name" 
                  ng-class="{'empty-input':!x.name}" 
                  ng-model="x.name"
                  ng-blur="updateWellB($index,x)"
                  ng-focus="focusWell('B', $index, x.name)"
                  ng-if="!isControlWell(x, $index, 'B')"
                  >
                <label class="CG1 type" ng-class="{'positive': x.name == 'Positive Control', 'negative': x.name == 'Negative Control', 'available': x.id}">
                  {{(x.name == 'Positive Control') ? '+' : ( (x.name == 'Negative Control') ? '-' : 'S' )}}
                </label>
                <img src="/images/dynexp/pika-test/note-disable.svg" class="note" ng-if="!x.id"/>
                <img src="/images/dynexp/pika-test/note-on.svg" class="note cursor-pointer note-{{'B'+$index}}" ng-if="x.id && x.notes" ng-click="openNotes($index, x, 'B')"/>
                <img src="/images/dynexp/pika-test/note-off.svg" class="note cursor-pointer note-{{'B'+$index}}" ng-if="x.id && !x.notes" ng-click="openNotes($index, x, 'B')"/>
              </div>
            </div>
          </div>
        </div>
      </section>
      <section class="well-command">
        <div class="mini-map">
          <table>
            <tr class="map-col-header">
              <td></td>
              <td class="CG2" ng-repeat="x in samples track by $index">{{$index + 1}}</td>
            </tr>
            <tr>
              <td class="map-row-header CG1">A</td>
              <td class="CG2" ng-repeat="x in samples track by $index">
                <label class="CG1 type" ng-class="{'positive': x.name == 'Positive Control', 'negative': x.name == 'Negative Control', 'available': x.id, 'active': (current_well_index == $index && current_well_row == 'A')}">
                  {{(x.name == 'Positive Control') ? '+' : ( (x.name == 'Negative Control') ? '-' : 'S' )}}
                </label>
              </td>
            </tr>
            <tr>
              <td class="map-row-header CG1">B</td>
              <td class="CG2" ng-repeat="x in samples_B track by $index">
                <label class="CG1 type" ng-class="{'positive': x.name == 'Positive Control', 'negative': x.name == 'Negative Control', 'available': x.id, 'active': (current_well_index == $index && current_well_row == 'B')}">
                  {{(x.name == 'Positive Control') ? '+' : ( (x.name == 'Negative Control') ? '-' : 'S' )}}
                </label>
              </td>
            </tr>
          </table>
          <div class="control-check">
            <div class="well-check CB2-M">
              <label ng-click="omitPositive()"><img src="/images/omit_check.svg" ng-show="omit_positive"></label>Omit Positive Control
            </div>
            <span class="CB3">Positive samples may not be called</span>
            <a class="CB3-M" ng-click="omit_negative_help = false; omit_positive_help = !omit_positive_help">Learn More</a>
            <div class="omit-tooltip" ng-show="omit_positive_help">
              <a><img src="/images/x_k.svg" ng-click="omit_positive_help = !omit_positive_help"></a>
              <p class="CB2">In order to call a positive sample, it is necessary for one well to return a valid negative result. Without this, we cannot conclude that positive results are real, and not the result of PCR contamination. <br/><br/>The negative control should only be omitted if you expect at least one negative result, i.e. you are running a high number of samples and expect most will be negative.</p>
            </div>
          </div>
          <div class="control-check">
            <div class="well-check CB2-M">
              <label ng-click="omitNegative()"><img src="/images/omit_check.svg" ng-show="omit_negative"></label>Omit Negative Control
            </div>
            <span class="CB3">Positive samples may not be called</span>
            <a class="CB3-M" ng-click="omit_positive_help = false; omit_negative_help = !omit_negative_help">Learn More</a>
            <div class="omit-tooltip" ng-show="omit_negative_help">
              <a><img src="/images/x_k.svg" ng-click="omit_negative_help = !omit_negative_help"></a>
              <p class="CB2">In order to call a positive sample, it is necessary for one well to return a valid negative result. Without this, we cannot conclude that positive results are real, and not the result of PCR contamination. <br/><br/>The negative control should only be omitted if you expect at least one negative result, i.e. you are running a high number of samples and expect most will be negative.</p>
            </div>
          </div>
        </div>
        <button class="button-start-exp CB1-M" ng-if="!start_confirm_show" ng-click="startConfirm()">Start Experiment</button>
        <button class="button-confirm-exp CB1-M" ng-if="start_confirm_show" ng-click="startExperiment()">Confirm Start</button>
      </section>
    </div>
  </div>
</div>